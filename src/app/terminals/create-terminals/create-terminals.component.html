<div class="container">

    <mat-card>

      <form [formGroup]="createTerminalForm">

        <mat-card-content>
          <h3 class="mat-h3" fxFlexFill>{{'Terminal_Component.FormTerminal.labelEdit'|translate}}</h3>
          <div fxLayout="row wrap" fxLayoutGap="2%" fxLayout.lt-md="column">

            <mat-form-field *ngIf="createTerminalForm.contains('terminalId')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelTerminalId' |translate}}</mat-label>
                <input matInput required formControlName="terminalId">
                <mat-error *ngIf="createTerminalForm.controls.terminalId.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.terminalId.hasError('pattern')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelTerminalNameMsgPattern' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('terminalCode')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelTerminalCode' |translate}}</mat-label>
                <input matInput required formControlName="terminalCode">
                <mat-error *ngIf="createTerminalForm.controls.terminalCode.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('terminalName')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelTerminalName' |translate}}</mat-label>
                <input matInput required formControlName="terminalName">
                <mat-error *ngIf="createTerminalForm.controls.terminalName.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('merchantId')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelMerchantId' |translate}}</mat-label>
                <mat-select required formControlName="merchantId">
                    <mat-option *ngFor="let type of merchants" [value]="type.name">
                      {{ type.name }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="createTerminalForm.controls.merchantId.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('limitAmount')" fxFlex="48%">
              <mat-label>{{'Terminal_Component.FormTerminal.labelLimitPerDay' |translate}}</mat-label>
              <input currencyMask matInput required formControlName="limitAmount">
              <mat-error *ngIf="createTerminalForm.controls.limitAmount.hasError('required')"
                [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
              <mat-error *ngIf="createTerminalForm.controls.limitAmount.hasError('min')"
                [innerHTML]="'Terminal_Component.FormTerminal.labelMsgMin0' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('officeId')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelOffice' |translate}}</mat-label>
                <mat-select required formControlName="officeId">
                    <mat-option *ngFor="let o of offices" [value]="o.officeId">
                      {{ o.name }}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="createTerminalForm.controls.officeId.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
            </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('bankCode')" fxFlex="48%">
              <mat-label>Ngân hàng</mat-label>
              <mat-select required formControlName="bankCode">
                  <mat-option *ngFor="let bank of banks" [value]="bank.bankCode">
                    {{ bank.bankName }}
                  </mat-option>
              </mat-select>
              <mat-error *ngIf="createTerminalForm.controls.officeId.hasError('required')"
                [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
          </mat-form-field>

          <mat-form-field *ngIf="createTerminalForm.contains('timeChargeValid')" fxFlex="48%">
            <mat-label>Số lần cà/ngày</mat-label>
            <input  matInput required formControlName="timeChargeValid">
            <mat-error *ngIf="createTerminalForm.controls.timeChargeValid.hasError('required')"
              [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
            <mat-error *ngIf="createTerminalForm.controls.timeChargeValid.hasError('min')"
              [innerHTML]="'Terminal_Component.FormTerminal.labelMsgMin0' |translate"></mat-error>
              <mat-error *ngIf="createTerminalForm.controls.timeChargeValid.hasError('max')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMax' |translate"></mat-error>
          </mat-form-field>

            <mat-form-field *ngIf="createTerminalForm.contains('minFeeDefault')" fxFlex="48%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelMinFeeDefault' |translate}}</mat-label>
                <input currencyMask matInput required formControlName="minFeeDefault" >
                <mat-error *ngIf="createTerminalForm.controls.minFeeDefault.hasError('required')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelRequired' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.minFeeDefault.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgMin0' |translate"></mat-error>
            </mat-form-field>

            <mat-checkbox fxFlex="48%" labelPosition="before" formControlName="status" class="activeCheckBox">
                {{'Terminal_Component.FormTerminal.checkboxIsActive' |translate}}
            </mat-checkbox>
          </div>
          <br/>
          <h3 class="mat-h3" fxFlexFill>{{'Terminal_Component.FormTerminal.labelGeneral'|translate}}</h3>

          <div fxLayout="row wrap" fxLayoutGap="2%" fxLayout.lt-md="column">
            <mat-form-field *ngIf="createTerminalForm.contains('costPercentage')" fxFlex="10%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelCostPercentage' |translate}}</mat-label>
                <input matInput required formControlName="costPercentage" type="number"  >
                <mat-error *ngIf="createTerminalForm.controls.costPercentage.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMin' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.costPercentage.hasError('max')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMax' |translate"></mat-error>
            </mat-form-field>
            <mat-form-field *ngIf="createTerminalForm.contains('cogsPercentage')" fxFlex="10%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelCogsPercentage' |translate}}</mat-label>
                <input  matInput required formControlName="cogsPercentage" type="number">
                <mat-error *ngIf="createTerminalForm.controls.cogsPercentage.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMin' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.cogsPercentage.hasError('max')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMax' |translate"></mat-error>
            </mat-form-field>
            <mat-form-field *ngIf="createTerminalForm.contains('txnRateMin')" fxFlex="10%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelMinPercentage' |translate}}</mat-label>
                <input  matInput required formControlName="txnRateMin" type="number">
                <mat-error *ngIf="createTerminalForm.controls.txnRateMin.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMin' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.txnRateMin.hasError('max')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMax' |translate"></mat-error>
            </mat-form-field>
            <mat-form-field *ngIf="createTerminalForm.contains('txnRateMax')" fxFlex="10%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelMaxPercentage' |translate}}</mat-label>
                <input  matInput required formControlName="txnRateMax" type="number">
                <mat-error *ngIf="createTerminalForm.controls.txnRateMax.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMin' |translate"></mat-error>
                <mat-error *ngIf="createTerminalForm.controls.txnRateMax.hasError('max')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgOutOffMax' |translate"></mat-error>
            </mat-form-field>
            <mat-form-field *ngIf="createTerminalForm.contains('maxLimitAmount')" fxFlex="12%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelMaxLimitAmount' |translate}}</mat-label>
                <input currencyMask matInput required formControlName="maxLimitAmount" >
                <mat-error *ngIf="createTerminalForm.controls.maxLimitAmount.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgMin100000' |translate"></mat-error>
            </mat-form-field>
            <mat-form-field *ngIf="createTerminalForm.contains('levelLimit')" fxFlex="12%">
                <mat-label>{{'Terminal_Component.FormTerminal.labelLevelLimit' |translate}}</mat-label>
                <input currencyMask matInput required formControlName="levelLimit" >
                <mat-error *ngIf="createTerminalForm.controls.levelLimit.hasError('min')"
                  [innerHTML]="'Terminal_Component.FormTerminal.labelMsgMin0' |translate"></mat-error>
            </mat-form-field>

            <button mat-raised-button color="primary" (click)="setDefaultFeeSettingPos()">
              <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-box-arrow-in-down-left" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M9.636 2.5a.5.5 0 0 0-.5-.5H2.5A1.5 1.5 0 0 0 1 3.5v10A1.5 1.5 0 0 0 2.5 15h10a1.5 1.5 0 0 0 1.5-1.5V6.864a.5.5 0 0 0-1 0V13.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z"/>
                <path fill-rule="evenodd" d="M5 10.5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1H6.707l8.147-8.146a.5.5 0 0 0-.708-.708L6 9.293V5.5a.5.5 0 0 0-1 0v5z"/>
              </svg>
              {{'Terminal_Component.FormTerminal.buttonSetupAll' |translate}}
            </button>
          </div>
        </mat-card-content>

        <div class="example-container mat-elevation-z8">
            <mat-form-field class="filter">
              <input matInput #filter (keyup)="applyFilter($event.target.value)" placeholder="Filter">
              <button mat-icon-button matSuffix aria-label="clear" *ngIf="filter.value" (click)="filter.value=''; applyFilter('');">
                <mat-icon>close</mat-icon>
              </button>
            </mat-form-field>
          <mat-table #table [dataSource]="dataSource">
            <ng-container matColumnDef="Office">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.Office'|translate}} </mat-header-cell>
              <mat-cell *matCellDef="let element">{{element.officeName}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="CardType">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.CardType'|translate}} </mat-header-cell>
              <mat-cell *matCellDef="let element">{{element.cardCode}} </mat-cell>
            </ng-container>

            <ng-container matColumnDef="FeePOS">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.FeePOS'|translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element, let i = index">
                <mat-form-field  >
                  <input type="number" matInput (keyup)="validateNumber($event, element)" id="{{i}}_cogsPercentage" [value]="element.cogsPercentage" [(ngModel)]="element.cogsPercentage" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="FeeCost">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.FeeCost'|translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element , let i = index">
                <mat-form-field floatLabel="never">
                  <input matInput (keyup)="validateNumber($event, element)" id="{{i}}_costPercentage" [value]="element.costPercentage" [(ngModel)]="element.costPercentage" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="FeeMin">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.FeeMin'|translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element, let i = index">
                <mat-form-field floatLabel="never">
                  <input matInput (keyup)="validateNumber($event, element)" [value]="element.txnRateMin" id="{{i}}_txnRateMin" [(ngModel)]="element.txnRateMin" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="FeeMax">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.FeeMax'|translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element, let i = index">
                <mat-form-field floatLabel="never">
                  <input matInput (keyup)="validateNumber($event, element)" id="{{i}}_txnRateMax" [value]="element.txnRateMax" [(ngModel)]="element.txnRateMax" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="MaxLimitAmountTransaction">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.MaxLimitAmountTransaction'|translate}} ({{'labelCurrency'|translate}})</mat-header-cell>
              <mat-cell *matCellDef="let element, let i = index">
                <mat-form-field floatLabel="never">
                  <input matInput  (keyup)="validateNumber($event, element)" id="{{i}}_maxLimitAmount" [value]="element.maxLimitAmount" [(ngModel)]="element.maxLimitAmount" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>

            <ng-container matColumnDef="LevelTransactionCard">
              <mat-header-cell *matHeaderCellDef>{{'Terminal_Component.FormTerminal.tableFee.LevelTransactionCard'|translate}}</mat-header-cell>
              <mat-cell *matCellDef="let element, let i = index">
                <mat-form-field floatLabel="never">
                  <input matInput (keyup)="validateNumber($event, element)" id="{{i}}_levelLimit" [value]="element.levelLimit" [(ngModel)]="element.levelLimit" [ngModelOptions]="{standalone: true}">
                </mat-form-field>
              </mat-cell>
            </ng-container>
            <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
          </mat-table>
          <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
        </div>
        <div class="mat-elevation-z8" style="text-align: center;">

          <button  mat-raised-button color="primary" (click)="backClicked()">
            <i class="fa fa-arrow-left" aria-hidden="true">{{'Terminal_Component.FormTerminal.buttonBackClicked'|translate}}</i>
          </button>

          <button  mat-raised-button color="primary" (click)="submit()" style="margin-left: 20px;">
            <i class="fa fa-floppy-o" aria-hidden="true">{{'Terminal_Component.FormTerminal.buttonSubmit'|translate}}</i>
          </button>

        </div>
      </form>
    </mat-card>

  </div>
